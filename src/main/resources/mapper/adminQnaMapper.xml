<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mf.mapper.AdminQnaMapper">
    <select id="getAllAdminQnas">
SELECT 
    CS_QUESTION.QUESTION_IDX,
    CS_QUESTION.TITLE,
    CS_QUESTION.CONTENT,
    CS_QUESTION.CREATE_DATE,
    CS_QUESTION.UPDATE_DATE,
    CS_QUESTION.STATE,
    USERS.ID
FROM 
    CS_QUESTION
JOIN 
    USERS ON CS_QUESTION.USER_IDX = USERS.USER_IDX
    </select>
    <insert id="setCsQna">
    insert into cs_qna(QNA_IDX,CS_IDX)
    values(cs_qna_seq.nextval,1)
    </insert>
    
    <insert id="addQuestion">
    
        INSERT INTO CS_QUESTION  (
        QUESTION_IDX,
        title, 
        content,
        STATE,
        qna_idx,
        user_idx
        ) 
        VALUES (
        cs_question_seq.NEXTVAL,
        #{title},
        #{content},
		1,
		CS_QNA_SEQ.CURRVAL,
		#{userIdx}		
         )
    </insert>
   <!-- 특정 FAQ 항목 가져오기 -->
  <select id="getQnaByquestionIdx" >
    SELECT 
        q.question_idx AS questionIdx,
        q.title,
        u.id AS id,
        q.content,
        q.create_date AS createDate,
        q.update_date AS updateDate
    FROM 
        cs_question q
    JOIN 
        users u ON q.user_idx = u.user_idx
    WHERE 
        q.question_idx = #{questionIdx}
</select>

  <!-- 답변 삽입 -->
    <insert id="insertAnswer" parameterType="com.mf.dto.AdminAnswerDto">
        INSERT INTO cs_answer (answer_idx, title, content, create_date, update_date, question_idx)
        VALUES (cs_answer_seq.nextval, #{title}, #{content}, SYSDATE, SYSDATE, #{questionIdx})
    </insert>

    <!-- 특정 QnA의 답변 가져오기 -->
    <select id="getAnswersByQuestionIdx" resultType="com.mf.dto.AdminAnswerDto">
        SELECT 
            answer_idx AS answerIdx,
            title,
            content,
            create_date AS createDate,
            update_date AS updateDate,
            question_idx AS questionIdx
        FROM 
            cs_answer
        WHERE 
            question_idx = #{questionIdx}
    </select>
</mapper>