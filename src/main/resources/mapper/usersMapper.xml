<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mf.mapper.UsersMapper">

<select id="findById" parameterType="string" resultType="com.mf.dto.UsersDto">
	SELECT * FROM USERS WHERE ID = #{id} and state=1
</select>

<select id="getId">
SELECT ID FROM USERS WHERE ID = #{id}
</select>

<insert id="joinProcess">
	INSERT INTO USERS(USER_IDX,ID,PW,STATE,ROLE)
	VALUES(USER_SEQ.NEXTVAL,#{id},#{pw},1,'ROLE_PERSON')
</insert>

<insert id="joinDetailProcess">
INSERT INTO PERSON(
USER_IDX,
PERSON_IDX,
NAME,
NICK_NAME,
EMAIL,
PHONE,
POST_CODE,
ADDRESS,
DETAIL_ADDRESS
)
VALUES(
USER_SEQ.CURRVAL,
PERSON_SEQ.NEXTVAL,
#{name},
#{nickName},
#{email},
#{phone},
#{postCode},
#{address},
#{detailAddress}
)
</insert>

<insert id="storeJoinProcess">
	INSERT INTO USERS(USER_IDX,ID,PW,STATE,ROLE)
	VALUES(USER_SEQ.NEXTVAL,#{id},#{pw},1,'ROLE_SHOP')
</insert>

<insert id="storeJoinDetailProcess">
INSERT INTO STORE(
STORE_IDX,
STORE_NAME,
MANAGER_NAME,
BUSINESS_NUMBER,
EMAIL,
PHONE,
POST_CODE,
ADDRESS,
DETAIL_ADDRESS,
USER_IDX
)
VALUES(
STORE_SEQ.NEXTVAL,
#{storeName},
#{managerName},
#{businessNumber},
#{email},
#{phone},
#{postCode},
#{address},
#{detailAddress},
USER_SEQ.CURRVAL
)
</insert>

</mapper>